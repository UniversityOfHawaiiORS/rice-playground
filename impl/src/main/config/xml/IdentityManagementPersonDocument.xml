<?xml version="1.0" encoding="UTF-8"?>
<data xmlns="ns:workflow" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="ns:workflow resource:WorkflowData">



	<ruleAttributes  xmlns="ns:workflow/RuleAttribute"
		xsi:schemaLocation="ns:workflow/RuleAttribute resource:RuleAttribute">
		<ruleAttribute>
			<name>NameSpaceApprovalAttribute</name>
			<className>
				org.kuali.rice.kew.rule.xmlrouting.StandardGenericXMLRuleAttribute
			</className>
			<label>NameSpaceApprovalAttribute</label>
			<description>NameSpaceApprovalAttribute</description>
			<type>RuleXmlAttribute</type>
			<routingConfig>
				<fieldDef name="namespaceCode" title="Namespace Code"
					workflowType="RULE">
					<display>
						<type>text</type>
					</display>
					<validation required="false" />
					<fieldEvaluation>
						<xpathexpression>
						  	wf:xstreamsafe('//document/roles/org.kuali.rice.kim.bo.ui.PersonDocumentRole/namespaceCode')= wf:ruledata('namespaceCode') or
						  	 wf:xstreamsafe('//document/groups/org.kuali.rice.kim.bo.ui.PersonDocumentGroup/namespaceCode')= wf:ruledata('namespaceCode')
						</xpathexpression>
					</fieldEvaluation>
				</fieldDef>
			</routingConfig>
		</ruleAttribute>
	</ruleAttributes>

<!--  for KIM Person/role/group document -->
   <documentTypes xmlns="ns:workflow/DocumentType" xsi:schemaLocation="ns:workflow/DocumentType resource:DocumentType">
        <documentType>
            <name>IdentityManagementPersonDocument</name>
            <description>Create Person Document</description>
            <label>Person Document</label>
            <postProcessorName>org.kuali.rice.kns.workflow.postprocessor.KualiPostProcessor</postProcessorName>
            <superUserWorkgroupName>KR-WKFLW:WorkflowAdmin</superUserWorkgroupName>
            <blanketApproveWorkgroupName>KR-WKFLW:WorkflowAdmin</blanketApproveWorkgroupName>
            <defaultExceptionWorkgroupName>KR-WKFLW:WorkflowAdmin</defaultExceptionWorkgroupName>
            <docHandler>${application.url}/kim/identityManagementPersonDocument.do?methodToCall=docHandler</docHandler>
            <routePaths>
                <routePath>
					<start name="Initiated" nextNode="NameSpace" />
					<requests name="NameSpace" nextNode="Final" />
					<requests name="Final" />
                </routePath>
            </routePaths>
            <routeNodes>
				<start name="Initiated">
					<activationType>P</activationType>
					<mandatoryRoute>false</mandatoryRoute>
					<finalApproval>false</finalApproval>
				</start>
				<requests name="NameSpace">
					<activationType>S</activationType>
					<ruleTemplate>NameSpaceApproval</ruleTemplate>
					<mandatoryRoute>false</mandatoryRoute>
					<finalApproval>false</finalApproval>
				</requests>
				<requests name="Final">
					<activationType>P</activationType>
					<ruleTemplate>FinalApproval</ruleTemplate>
					<mandatoryRoute>false</mandatoryRoute>
					<finalApproval>false</finalApproval>
				</requests>
            </routeNodes>
        </documentType>

<!-- end KIM document -->
  </documentTypes>

  	<ruleTemplates xmlns="ns:workflow/RuleTemplate"
		xsi:schemaLocation="ns:workflow/RuleTemplate resource:RuleTemplate">
		<ruleTemplate allowOverwrite="true">
			<name>FinalApproval</name>
			<description>Final Approval Routing Rule</description>
		</ruleTemplate>
		<ruleTemplate allowOverwrite="true">
			<name>NameSpaceApproval</name>
			<description>
				Name space Approval Routing Rule
			</description>
			<attributes>
				<attribute>
					<name>NameSpaceApprovalAttribute</name>
					<required>false</required>
				</attribute>
			</attributes>
		</ruleTemplate>
	</ruleTemplates>



  <rules xmlns="ns:workflow/Rule" xsi:schemaLocation="ns:workflow/Rule resource:Rule">
    <rule>
       <documentType>IdentityManagementPersonDocument</documentType>
      <ruleTemplate>FinalApproval</ruleTemplate>
       <description>Final approval</description>
       <ignorePrevious>true</ignorePrevious>
      <responsibilities>
        <responsibility>
          <user>admin</user>
          <actionRequested>A</actionRequested>
          <priority>1</priority>
        </responsibility>
      </responsibilities>
    </rule>


   <rule>
      <documentType>IdentityManagementPersonDocument</documentType>
      <ruleTemplate>NameSpaceApproval</ruleTemplate>
      <description>Name space approval Rule for KFS</description>
      <ignorePrevious>false</ignorePrevious>
      <ruleExtensions>
        <ruleExtension>
          <attribute>NameSpaceApprovalAttribute</attribute>
          <ruleTemplate>NameSpaceApproval</ruleTemplate>
          <ruleExtensionValues>
            <ruleExtensionValue>
              <key>namespaceCode</key>
              <value>KFS</value>
            </ruleExtensionValue>
          </ruleExtensionValues>
        </ruleExtension>
      </ruleExtensions>
      <responsibilities>
                <responsibility>
                  <user>admin</user>
                </responsibility>
       </responsibilities>
    </rule>


</rules>




</data>
