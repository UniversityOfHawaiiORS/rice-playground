<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
                           http://www.springframework.org/schema/tx
                           http://www.springframework.org/schema/tx/spring-tx-2.0.xsd
                           http://www.springframework.org/schema/aop
                           http://www.springframework.org/schema/aop/spring-aop-2.0.xsd">

  <bean class="org.kuali.rice.core.config.spring.ConfigPropertyPlaceholderConfigurer"/>

  <bean id="ojbConfigurer" class="org.kuali.rice.core.ojb.JtaOjbConfigurer">
    <property name="transactionManager" ref="jtaTransactionManager"/>
  </bean>

  <bean id="userTransaction" class="org.kuali.rice.core.jta.UserTransactionFactoryBean"/>
  <bean id="jtaTransactionManager" class="org.kuali.rice.core.jta.TransactionManagerFactoryBean"/>

	<bean id="transactionManager" class="org.springframework.transaction.jta.JtaTransactionManager" lazy-init="true">
		<property name="userTransaction">
			<ref local="userTransaction" />
   		</property>
		<property name="transactionManager">
			<ref local="jtaTransactionManager" />
    </property>
	</bean>
  
	<bean id="enWorkflowDataSource" class="org.kuali.rice.core.database.PrimaryDataSourceFactoryBean">
        <property name="preferredDataSourceParams">
			<list>
				<value>org.kuali.workflow.datasource</value>
			</list>
		</property>
		<property name="preferredDataSourceJndiParams">
			<list>
				<value>org.kuali.workflow.datasource.jndi.location</value>
			</list>
		</property>
    </bean>

	<bean id="transactionTemplate" class="org.springframework.transaction.support.TransactionTemplate">
		<property name="transactionManager">
			<ref bean="transactionManager" />
		</property>
	</bean>


	<bean id="matchAllWithPropReqCheckedException" class="org.springframework.transaction.interceptor.MatchAlwaysTransactionAttributeSource">
		<property name="transactionAttribute">
			<value>PROPAGATION_REQUIRED,-Exception</value>
		</property>
	</bean>
	
	

	<!-- Proxy for rollback on only runtime exceptions -->

	<!-- PROPAGATION REQUIRED TX DECLARATIONS -->
	<bean id="matchAllWithPropReq" class="org.springframework.transaction.interceptor.MatchAlwaysTransactionAttributeSource">
		<property name="transactionAttribute">
			<value>PROPAGATION_REQUIRED</value>
		</property>
	</bean>

	<bean id="matchAllTxInterceptor" class="org.springframework.transaction.interceptor.TransactionInterceptor">
		<property name="transactionManager">
			<ref bean="transactionManager" />
		</property>
		<property name="transactionAttributeSource">
			<ref bean="matchAllWithPropReq" />
		</property>
	</bean>

	<bean class="org.springframework.aop.framework.autoproxy.BeanNameAutoProxyCreator">
		<property name="interceptorNames">
			<list>
				<idref local="matchAllTxInterceptor" />
			</list>
		</property>
		<property name="beanNames">
			<list>
				<idref local="enRuleAttributeService" />
				<idref local="enRuleTemplateService" />
				<idref local="enRuleService" />
				<idref local="enDocumentRouteHeaderService" />
				<idref local="enActionListService" />
				<idref local="enDocumentSearchService" />
				<idref local="enDocumentTypeService" />
				<idref local="enPreferencesService" />
				<idref local="enActionTakenService" />
				<idref local="enApplicationConstantsService" />
				<idref local="enActionRequestService" />
				<idref local="enResponsibilityIdService" />
				<idref local="enRuleDelegationService" />
				<idref local="enEmailService" />
				<idref local="enNotificationService" />
				<idref local="enRouteModuleService" />
				<idref local="enWorkflowDocumentService" />
				<idref local="enRoleService" />
				<idref local="enRoutingReportService" />
                <idref local="enExtractService" />
				<idref local="workflowEngine" />
				<idref local="enRouteNodeService" />
				<idref local="enBranchService" />
				<idref local="enExceptionRoutingService" />
                <idref local="enHelpService" />
                <idref local="enEDocLiteService" />
                <idref local="enStyleService" />
                <idref local="enXmlDigesterService" />
                <idref local="enStatsService" />
                <idref local="enNoteService" />
                <idref local="enUserService"/>
                <idref local="enWorkgroupService"/>
                <idref local="enWorkgroupDAO"/>
                <idref local="enWorkgroupMemberDAO"/>
                <idref local="enUserDAO"/>
                <idref local="enWorkgroupRoutingService"/>
                <idref local="workgroupTypeService"/>
                <idref local="enDocumentRoutingService" />
                <idref local="enBlanketApproveProcessor" />
                <idref local="enSearchableAttributeProcessor" />
                <idref local="enMoveDocumentService" />
                <idref local="enActionInvocationService" />
                <idref local="enImmediateEmailReminderService" />
                <idref local="enActionListEmailService" />
                <idref local="enWorkflowUtilityService" />
                <idref local="enWorkflowDocumentActionsService" />
                <idref local="enRemoveReplaceDocumentService"/>
                <!-- it's important that this service remains non-transactionally proxied for various reasons
                <idref local="enUserOptionsService"/>
                -->
			</list>
		</property>
	</bean>

	<!--  END PROPAGATION REQUIRED TX DECLARATIONS -->




	<!-- WorkflowDocument -->
	<bean id="enWorkflowDocumentService" class="org.kuali.rice.kew.routeheader.service.impl.WorkflowDocumentServiceImpl" lazy-init="true" />


	<!--  RouteModuleService -->
	<bean id="enRouteModuleService" class="org.kuali.rice.kew.routemodule.service.impl.RouteModuleServiceImpl"  lazy-init="true"/>

	<!-- 2.1 Workflow Engine -->
	<bean id="workflowEngine" class="org.kuali.rice.kew.engine.StandardWorkflowEngine"  lazy-init="true"/>

	<bean id="enRouteNodeService" class="org.kuali.rice.kew.engine.node.service.impl.RouteNodeServiceImpl" lazy-init="true">
		<property name="routeNodeDAO">
			<ref bean="enRouteNodeDAO" />
		</property>
	</bean>



	<bean id="enRouteNodeDAO" class="org.kuali.rice.kew.engine.node.dao.impl.RouteNodeDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>


	<bean id="enBranchService" class="org.kuali.rice.kew.engine.node.service.impl.BranchServiceImpl" lazy-init="true">
		<property name="branchDAO">
			<ref bean="enBranchDAO"/>
		</property>
	</bean>

	<bean id="enBranchDAO" class="org.kuali.rice.kew.engine.node.dao.impl.BranchDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>

	<!--  ResponsibilityIdService -->
	<bean id="enResponsibilityIdService" class="org.kuali.rice.kew.responsibility.service.impl.ResponsibilityIdServiceImpl" lazy-init="true">
		<property name="responsibilityIdDAO">
			<ref bean="enResponsibilityIdDAO" />
		</property>
	</bean>
	<bean id="enResponsibilityIdDAO" class="org.kuali.rice.kew.responsibility.dao.impl.ResponsibilityIdDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>
	<!--  ActionRequestService -->
	<bean id="enActionRequestService" class="org.kuali.rice.kew.actionrequest.service.impl.ActionRequestServiceImpl" lazy-init="true">
		<property name="actionRequestDAO">
			<ref bean="enActionRequestDAO" />
		</property>
	</bean>
	<bean id="enActionRequestDAO" class="org.kuali.rice.kew.actionrequest.dao.impl.ActionRequestDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>
	<!--  RuleAttributeService -->
	<bean id="enRuleAttributeService" class="org.kuali.rice.kew.rule.service.impl.RuleAttributeServiceImpl" lazy-init="true">
		<property name="ruleAttributeDAO">
			<ref bean="enRuleAttributeDAO" />
		</property>
	</bean>
	<bean id="enRuleAttributeDAO" class="org.kuali.rice.kew.rule.dao.impl.RuleAttributeDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>
	<!--  RuleTemplateService -->
	<bean id="enRuleTemplateService" class="org.kuali.rice.kew.rule.service.impl.RuleTemplateServiceImpl" lazy-init="true">
		<property name="ruleTemplateDAO">
			<ref bean="enRuleTemplateDAO" />
		</property>
		<property name="ruleTemplateAttributeDAO">
			<ref bean="enRuleTemplateAttributeDAO" />
		</property>
		<property name="ruleTemplateOptionDAO">
			<ref bean="enRuleTemplateOptionDAO" />
		</property>
		<property name="ruleDAO">
			<ref bean="enRuleDAO" />
		</property>
		<property name="ruleDelegationDAO">
			<ref bean="enRuleDelegationDAO" />
		</property>
	</bean>
	<bean id="enRuleTemplateAttributeDAO" class="org.kuali.rice.kew.rule.dao.impl.RuleTemplateAttributeDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>
	<bean id="enRuleTemplateOptionDAO" class="org.kuali.rice.kew.rule.dao.impl.RuleTemplateOptionDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>
	<bean id="enRuleTemplateDAO" class="org.kuali.rice.kew.rule.dao.impl.RuleTemplateDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>
	<!--  RuleDelegationService -->
	<bean id="enRuleDelegationService" class="org.kuali.rice.kew.rule.service.impl.RuleDelegationServiceImpl" lazy-init="true">
		<property name="ruleDelegationDAO">
			<ref bean="enRuleDelegationDAO" />
		</property>
	</bean>
	<bean id="enRuleDelegationDAO" class="org.kuali.rice.kew.rule.dao.impl.RuleDelegationDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>

	<!--  RuleService -->
	<bean id="enRuleService" class="org.kuali.rice.kew.rule.service.impl.RuleServiceImpl" lazy-init="true">
		<property name="ruleDAO">
			<ref bean="enRuleDAO" />
		</property>
		<property name="ruleResponsibilityDAO">
			<ref bean="enRuleResponsibilityDAO" />
		</property>
	</bean>
	<bean id="enRuleDAO" class="org.kuali.rice.kew.rule.dao.impl.RuleDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>

	<bean id="enRuleResponsibilityDAO" class="org.kuali.rice.kew.rule.dao.impl.RuleResponsibilityDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>

	<!--  RouteHeaderService -->
	<bean id="enDocumentRouteHeaderService" class="org.kuali.rice.kew.routeheader.service.impl.RouteHeaderServiceImpl" lazy-init="true">
		<property name="routeHeaderDAO">
			<ref bean="enDocumentRouteHeaderDAO" />
		</property>
	</bean>
	<bean id="enDocumentRouteHeaderDAO" class="org.kuali.rice.kew.routeheader.dao.impl.DocumentRouteHeaderDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>

  <!--  EDL Extract Service -->
  <bean id="enExtractService" class="org.kuali.rice.kew.edl.extract.ExtractServiceImpl">
    <property name="extractDAO">
      <bean class="org.kuali.rice.kew.edl.extract.dao.impl.ExtractDAOOjbImpl">
          <property name="jcdAlias" value="enWorkflowDataSource" />
      </bean>
    </property>
  </bean>

	<!--  Routing Report Service -->
	<bean id="enRoutingReportService" class="org.kuali.rice.kew.routemodule.service.impl.RoutingReportServiceImpl"  lazy-init="true"/>
	<!--  ActionListService -->
	<bean id="enActionListService" class="org.kuali.rice.kew.actionlist.service.impl.ActionListServiceImpl" lazy-init="true">
		<property name="actionListDAO">
			<ref bean="enActionListDAO" />
		</property>
		<property name="actionItemDAO">
			<ref bean="enActionItemDAO" />
		</property>
	</bean>
	<bean id="enActionListDAO" class="org.kuali.rice.kew.actionlist.dao.impl.ActionListDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>
	<bean id="enActionItemDAO" class="org.kuali.rice.kew.actionitem.dao.impl.ActionItemDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>

	<!--  DocumentSearchService -->
	<bean id="enDocumentSearchService" class="org.kuali.rice.kew.docsearch.service.impl.DocumentSearchServiceImpl" lazy-init="true">
		<property name="documentSearchDAO">
			<ref bean="enDocumentSearchDAO" />
		</property>
		<property name="userOptionsService">
			<ref bean="enUserOptionsService" />
		</property>
	</bean>
	<bean id="enDocumentSearchDAO" class="org.kuali.rice.kew.docsearch.dao.impl.DocumentSearchDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>

	<!--  DocumentTypeService -->
	<bean id="enDocumentTypeService" class="org.kuali.rice.kew.doctype.service.impl.DocumentTypeServiceImpl" lazy-init="true">
		<property name="documentTypeDAO">
			<ref bean="enDocumentTypeDAO" />
		</property>
	</bean>
	<bean id="enDocumentTypeDAO" class="org.kuali.rice.kew.doctype.dao.impl.DocumentTypeDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>

    <!--  DocumentSecurityService -->
    <bean id="enDocumentSecurityService" class="org.kuali.rice.kew.doctype.service.impl.DocumentSecurityServiceImpl"/>

	<!-- Exception routing service -->
	<bean id="enExceptionRoutingService" class="org.kuali.rice.ksb.messaging.exceptionhandling.ExceptionRoutingServiceImpl"  lazy-init="true"/>

	<!--  PreferencesService -->
	<bean id="enPreferencesService" class="org.kuali.rice.kew.preferences.service.impl.PreferencesServiceImpl" lazy-init="true" />
	<!--  UserOptionsService -->
	<bean id="enUserOptionsService" class="org.kuali.rice.kew.useroptions.UserOptionsServiceImpl" lazy-init="true">
		<property name="userOptionsDAO">
			<!-- <ref bean="enUserOptionsDAO" /> -->
      <ref bean="enUserOptionsOJBDAO" />
		</property>
	</bean>
  <bean id="enUserOptionsDAO" class="org.kuali.rice.kew.useroptions.dao.impl.UserOptionsDaoJpaImpl" lazy-init="true"/>
  
	<bean id="enUserOptionsOJBDAO" class="org.kuali.rice.kew.useroptions.dao.impl.UserOptionsDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>
  
  
	<!--  ActionTakenService -->
	<bean id="enActionTakenService" class="org.kuali.rice.kew.actiontaken.service.impl.ActionTakenServiceImpl" lazy-init="true">
		<property name="actionTakenDAO">
			<ref bean="enActionTakenDAO" />
		</property>
	</bean>
	<bean id="enActionTakenDAO" class="org.kuali.rice.kew.actiontaken.dao.impl.ActionTakenDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>


	<!--  RoleService -->
	<bean id="enRoleService" class="org.kuali.rice.kew.role.service.impl.RoleServiceImpl"  lazy-init="true">
      <property name="roleDAO">
        <bean class="org.kuali.rice.kew.role.dao.impl.RoleDAOOjbImpl">
          <property name="jcdAlias" value="enWorkflowDataSource"/>
        </bean>
      </property>
    </bean>

	<!-- Application Constants Service -->
  <bean id="enApplicationConstantsDAO" class="org.kuali.rice.kew.applicationconstants.dao.impl.ApplicationConstantsDaoJpaImpl"/>

    
	<bean id="enApplicationConstantsOJBDAO" class="org.kuali.rice.kew.applicationconstants.dao.impl.ApplicationConstantsDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
	</bean>


	<bean id="enApplicationConstantsService" class="org.kuali.rice.kew.applicationconstants.service.impl.ApplicationConstantsServiceImpl"
		depends-on="enWorkflowDataSource" lazy-init="true">
		<property name="applicationConstantsDAO">
      <!-- <ref bean="enApplicationConstantsDAO" /> -->
      <ref bean="enApplicationConstantsOJBDAO" />
		</property>
	</bean>

	<!-- Workflow Internal Lookups -->
	<bean id="DocumentTypeLookupableImplService" class="org.kuali.rice.kew.lookupable.DocumentTypeLookupableImpl" scope="prototype" />
	<bean id="RoleLookupableImplService" class="org.kuali.rice.kew.lookupable.RoleLookupableImpl" scope="prototype" />
	<bean id="RuleAttributeLookupableImplService" class="org.kuali.rice.kew.lookupable.RuleAttributeLookupableImpl" scope="prototype" />
	<bean id="RuleBaseValuesLookupableImplService" class="org.kuali.rice.kew.lookupable.RuleBaseValuesLookupableImpl" scope="prototype" />
	<bean id="RuleTemplateLookupableImplService" class="org.kuali.rice.kew.lookupable.RuleTemplateLookupableImpl" scope="prototype" />
	<bean id="EDocLiteLookupableService" class="org.kuali.rice.kew.lookupable.EDocLiteLookupable" scope="prototype" />
	<bean id="UserLookupableImplService" class="org.kuali.rice.kew.user.UserLookupableImpl" scope="prototype" />
	<bean id="WorkGroupLookupableImplService" class="org.kuali.rice.kew.workgroup.WorkGroupLookupableImpl" scope="prototype" />
    <bean id="WorkgroupTypeLookup" class="org.kuali.rice.kew.workgroup.WorkgroupTypeLookupable" scope="prototype"/>

	<bean id="enEmailService" class="org.kuali.rice.kew.mail.service.impl.DefaultEmailService"  lazy-init="true"/>

<!--
    <bean id="enEmailContentService" class="org.kuali.rice.kew.mail.service.impl.HardCodedEmailContentServiceImpl"  lazy-init="true"/>
    <bean id="enActionListEmailService" class="org.kuali.rice.kew.mail.service.impl.ActionListEmailServiceImpl">
      <property name="deploymentEnvironment">
        <value>${environment}</value>
      </property>
    </bean>
-->
	<bean id="enEmailContentService" class="org.kuali.rice.kew.mail.service.impl.StyleableEmailContentServiceImpl" lazy-init="true">
        <property name="styleService" ref="enStyleService"/>
    </bean>
    <bean id="enActionListEmailService" class="org.kuali.rice.kew.mail.service.impl.CustomizableActionListEmailServiceImpl">
        <property name="deploymentEnvironment">
            <value>${environment}</value>
        </property>
        <property name="emailContentGenerator" ref="enEmailContentService"/>
    </bean>

<!--	<bean id="enNotificationService" class="org.kuali.rice.kew.notification.service.impl.KCBNotificationService"  lazy-init="true"/> -->
    <bean id="enNotificationService" class="org.kuali.rice.kew.notification.service.impl.DefaultNotificationService"  lazy-init="true"/>

	<!-- db platform -->
	<bean id="enDbPlatform" class="org.kuali.rice.core.config.BeanHolder">
		<property name="objectType">
		  <value>${datasource.platform}</value>
	   </property>
    </bean>

	<!-- Action Registry -->
	<bean id="enActionRegistry" class="org.kuali.rice.kew.actions.ActionRegistryImpl" lazy-init="true"/>

    <!-- some beans shared by client and server -->

    <bean id="enXmlIngesterService" class="org.kuali.rice.kew.batch.XmlIngesterServiceImpl" lazy-init="true">
        <property name="xmlDigesterService">
          <ref bean="enXmlDigesterService"/>
        </property>
        <property name="validate">
            <value>true</value>
        </property>
        <property name="serviceOrder">
            <list>
                <value>enApplicationConstantsService</value>
                <value>enUserService</value>
                <value>enRuleAttributeService</value>
                <value>workgroupTypeService</value>
                <value>enWorkgroupService</value>
                <value>enRuleTemplateService</value>
                <value>enDocumentTypeService</value>
                <value>enRuleService</value>
                <value>enHelpService</value>
                <value>enEDocLiteService</value>
                <value>enStyleService</value>
            </list>
        </property>
    </bean>

    <bean id="enXmlDigesterService" class="org.kuali.rice.kew.batch.XmlDigesterServiceImpl"  lazy-init="true"/>


    <bean id="enEDocLiteDAO" class="org.kuali.rice.kew.edl.dao.impl.EDocLiteDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
    </bean>

    <bean id="enEDocLiteService" class="org.kuali.rice.kew.edl.service.impl.EDocLiteServiceImpl" lazy-init="true">
        <property name="EDocLiteDAO">
            <ref local="enEDocLiteDAO"/>
        </property>
        <property name="styleService">
            <ref local="enStyleService"/>
        </property>
    </bean>

    <bean id="enStyleService" class="org.kuali.rice.kew.edl.service.impl.StyleServiceImpl" lazy-init="true">
        <property name="styleDAO">
            <ref local="enEDocLiteDAO"/>
        </property>
    </bean>

    <bean id="enHelpService" class="org.kuali.rice.kew.help.service.impl.HelpServiceImpl" lazy-init="true">
        <property name="helpDAO">
            <!-- <ref bean="enHelpDAO" /> -->
            <ref bean="enHelpOJBDAO" />
        </property>
    </bean>

    <bean id="enHelpDAO" class="org.kuali.rice.kew.help.dao.impl.HelpDaoJpaImpl" lazy-init="true"/>
     
    <bean id="enHelpOJBDAO" class="org.kuali.rice.kew.help.dao.impl.HelpDAOOjbImpl" lazy-init="true">
		<property name="jcdAlias" value="enWorkflowDataSource" />
    </bean>

    <!-- <bean id="enEncryptionService" class="org.kuali.rice.core.service.impl.DESEncryptionService" lazy-init="true"/> -->
	<bean id="enEncryptionService" class="org.kuali.rice.core.service.impl.DemonstrationGradeEncryptionServiceImpl" lazy-init="true">
		<property name="secretKey">
			<value>${encryption.key}</value>
		</property>
	</bean>

  <bean id="matchAllTxCheckedExceptionInterceptor" class="org.springframework.transaction.interceptor.TransactionInterceptor">
    <property name="transactionManager">
      <ref bean="transactionManager" />
    </property>
    <property name="transactionAttributeSource">
      <ref bean="matchAllWithPropReqCheckedException" />
    </property>
  </bean>


  <bean id="checkedExceptionAutoProxyCreator" class="org.springframework.aop.framework.autoproxy.BeanNameAutoProxyCreator">
    <property name="interceptorNames">
      <list>
        <idref local="matchAllTxCheckedExceptionInterceptor" />
      </list>
    </property>
    <property name="beanNames">
      <list>
        <idref local="enWorkflowDocumentActionsService" />
      </list>
    </property>
  </bean>

  <bean id="enWorkflowDocumentActionsService" class="org.kuali.rice.kew.server.WorkflowDocumentActionsWebServiceImpl"  lazy-init="true"/>


  <bean id="enXmlPollerService" class="org.kuali.rice.kew.batch.XmlPollerServiceImpl">
    <property name="xmlPendingLocation">
      <value>${data.xml.pending.location}</value>
    </property>
    <property name="xmlCompletedLocation">
      <value>${data.xml.loaded.location}</value>
    </property>
    <property name="xmlProblemLocation">
      <value>${data.xml.problem.location}</value>
    </property>
    <property name="xmlParentDirectory">
      <value>${data.xml.root.location}</value>
    </property>
    <property name="pollIntervalSecs">
      <value>${data.xml.pollIntervalSecs}</value>
    </property>
    <property name="initialDelaySecs">
      <value>${initialDelaySecs}</value>
    </property>
  </bean>

  <bean id="enXmlExporterService" class="org.kuali.rice.kew.xml.export.XmlExporterServiceImpl" lazy-init="true">
    <property name="serviceOrder">
      <list>
        <value>enWorkgroupService</value>
        <value>workgroupTypeService</value>
        <value>enRuleAttributeService</value>
        <value>enDocumentTypeService</value>
        <value>enRuleTemplateService</value>
        <value>enRuleService</value>
        <value>enHelpService</value>
        <value>enEDocLiteService</value>
                <value>enStyleService</value>
      </list>
    </property>
  </bean>



  <!--  StatsService -->
  <bean id="enStatsService" class="org.kuali.rice.kew.stats.StatsServiceImpl">
    <property name="statsDAO">
      <ref bean="enStatsDAO" />
    </property>
  </bean>
  <bean id="enStatsDAO" class="org.kuali.rice.kew.stats.dao.impl.StatsDAOOjbImpl">
		<property name="jcdAlias" value="enWorkflowDataSource" />
  </bean>

  <!--  NoteService -->
  <bean id="enNoteService" class="org.kuali.rice.kew.notes.service.impl.NoteServiceImpl">
    <property name="noteDAO">
      <bean class="org.kuali.rice.kew.notes.dao.impl.NoteDAOOjbImpl">
				<property name="jcdAlias" value="enWorkflowDataSource" />
      </bean>
    </property>
    <property name="attachmentService">
      <bean class="org.kuali.rice.kew.notes.service.impl.AttachmentServiceImpl">
        <property name="attachmentDir" value="${attachment.dir.location}" />
      </bean>
    </property>
  </bean>

  <!--  QuickLinksService -->
  <bean id="enQuickLinksService" class="org.kuali.rice.kew.quicklinks.service.impl.QuickLinksServiceImpl">
    <property name="quickLinksDAO">
      <ref bean="enQuickLinksDAO" />
    </property>
  </bean>
  <bean id="enQuickLinksDAO" class="org.kuali.rice.kew.quicklinks.dao.impl.QuickLinksDAOOjbImpl">
		<property name="jcdAlias" value="enWorkflowDataSource" />
  </bean>

  <bean id="enWebAuthenticationService" class="org.kuali.rice.kew.web.RemoteUserWebAuthenticationService"/>

  <bean id="enWebAuthorizationService" class="org.kuali.rice.kew.web.DefaultWebAuthorizationService"/>

  <bean id="enUserService" class="org.kuali.rice.kew.user.BaseUserService">
    <property name="userDAO">
      <ref local="enUserDAO" />
    </property>
    </bean>

  <bean id="enUserDAO" class="org.kuali.rice.kew.user.dao.impl.BaseUserDAOOjbImpl">
      <property name="jcdAlias" value="enWorkflowDataSource" />
  </bean>

  <bean id="enWorkgroupDAO" class="org.kuali.rice.kew.workgroup.dao.impl.BaseWorkgroupDAOOjbImpl">
    <property name="jcdAlias" value="enWorkflowDataSource" />
  </bean>

  <bean id="enWorkgroupMemberDAO" class="org.kuali.rice.kew.workgroup.dao.impl.BaseWorkgroupMemberDAOOjbImpl">
    <property name="jcdAlias" value="enWorkflowDataSource" />
  </bean>

  <bean id="enWorkgroupService" class="org.kuali.rice.kew.workgroup.BaseWorkgroupService">
    <property name="workgroupDAO">
      <ref local="enWorkgroupDAO" />
    </property>
    <property name="workgroupMemberDAO">
      <ref local="enWorkgroupMemberDAO" />
    </property>
    </bean>

    <bean id="enWorkgroupRoutingService" class="org.kuali.rice.kew.workgroup.BaseWorkgroupRoutingService">
    <property name="workgroupDAO">
      <ref local="enWorkgroupDAO" />
    </property>
    </bean>

    <bean id="workgroupTypeDAO" class="org.kuali.rice.kew.workgroup.dao.impl.WorkgroupTypeDAOOjbImpl">
      <property name="jcdAlias" value="enWorkflowDataSource"/>
    </bean>

    <bean id="workgroupTypeService" class="org.kuali.rice.kew.workgroup.WorkgroupTypeServiceImpl">
      <property name="workgroupTypeDAO" ref="workgroupTypeDAO"/>
    </bean>

    <bean id="enRemoveReplaceDocumentService" class="org.kuali.rice.kew.removereplace.service.impl.RemoveReplaceDocumentServiceImpl">
      <property name="removeReplaceDocumentDAO">
        <bean class="org.kuali.rice.kew.removereplace.dao.impl.RemoveReplaceDocumentDAOOjbImpl">
          <property name="jcdAlias" value="enWorkflowDataSource"/>
        </bean>
      </property>
    </bean>


	<bean id="enWorkflowUtilityService" class="org.kuali.rice.kew.server.WorkflowUtilityWebServiceImpl" lazy-init="true" />
    <bean id="enDocumentRoutingService" class="org.kuali.rice.kew.messaging.RouteDocumentMessageService"/>
    <bean id="enBlanketApproveProcessor" class="org.kuali.rice.kew.actions.asyncservices.BlanketApproveProcessor"/>
    <bean id="enSearchableAttributeProcessor" class="org.kuali.rice.kew.docsearch.service.impl.SearchableAttributeProcessor"/>
    <bean id="enMoveDocumentService" class="org.kuali.rice.kew.actions.asyncservices.MoveDocumentProcessor" />
    <bean id="enActionInvocationService" class="org.kuali.rice.kew.actions.asyncservices.ActionInvocationProcessor" />
    <bean id="enImmediateEmailReminderService" class="org.kuali.rice.kew.mail.service.impl.ActionListImmediateProcessorImpl" />
    <bean id="simpleDocumentActionsService" class="org.kuali.rice.kew.server.SimpleDocumentActionsWebServiceImpl"/>

	<bean class="org.kuali.rice.ksb.messaging.KSBExporter">
		<property name="serviceDefinition">
        <bean class="org.kuali.rice.ksb.messaging.JavaServiceDefinition">
          <property name="service">
            <ref bean="enWorkflowDocumentActionsService" />
          </property>
          <property name="localServiceName" value="WorkflowDocumentActionsService" />
          <property name="priority" value="3" />
          <property name="retryAttempts" value="0" />
          <property name="busSecurity" value="${secure.workflowdocument.javaservice.endpoint}"/>
        </bean>
		</property>
	</bean>

	<bean class="org.kuali.rice.ksb.messaging.KSBExporter">
		<property name="serviceDefinition">
        <bean class="org.kuali.rice.ksb.messaging.JavaServiceDefinition">
          <property name="service">
            <ref bean="enWorkflowUtilityService" />
          </property>
          <property name="localServiceName" value="WorkflowUtilityService" />
          <property name="priority" value="3" />
          <property name="retryAttempts" value="0" />
          <property name="busSecurity" value="${secure.workflowutility.javaservice.endpoint}"/>
        </bean>
          </property>
    </bean>

    <bean class="org.kuali.rice.ksb.messaging.KSBExporter">
      <property name="serviceDefinition">
        <bean class="org.kuali.rice.ksb.messaging.SOAPServiceDefinition">
          <property name="service">
            <ref bean="simpleDocumentActionsService" />
          </property>
          <!-- <property name="serviceNameSpaceURI" value=""/> -->
          <property name="localServiceName" value="simpleDocumentActionsService" />
          <property name="priority" value="3" />
          <property name="retryAttempts" value="0" />
          <property name="busSecurity" value="${simpleDocumentActionsService.security}"/>
        </bean>
      </property>
    </bean>

	<bean class="org.kuali.rice.ksb.messaging.KSBExporter">
		<property name="serviceDefinition">
        <bean class="org.kuali.rice.ksb.messaging.JavaServiceDefinition">
          <property name="service">
            <ref bean="enActionListEmailService" />
          </property>
          <property name="localServiceName" value="enActionListEmailService" />
          <property name="serviceInterface" value="org.kuali.rice.kew.mail.service.ActionListEmailService" />
          <property name="priority" value="30"/>
          <property name="retryAttempts" value="3" />
        </bean>
		</property>
	</bean>

<!-- Because these services are commonly overridden by the Institutional Plugin if we just inject
     enUserService or enWorkgroupService here we won't get the overridden version of the service.
     There's really a larger issue here that needs to be addressed regarding the resource loading
     and the plugin framework in this case.  In the meantime, these exporters have been moved to the
   	 ExportOverridableServicesLifecycle
   	 
	<bean class="org.kuali.rice.ksb.messaging.PropertyConditionalKSBExporter">
		<property name="serviceDefinition">
        <bean class="org.kuali.rice.ksb.messaging.JavaServiceDefinition">
          <property name="service">
            <ref bean="enUserService" />
          </property>
          <property name="serviceInterface" value="org.kuali.rice.kew.user.UserService" />
          <property name="serviceNameSpaceURI" value=""/>
          <property name="localServiceName" value="enUserService" />
        </bean>
		</property>
		<property name="propertyName" value="Identity.useRemoteServices"/>
	</bean>

	<bean class="org.kuali.rice.ksb.messaging.PropertyConditionalKSBExporter">
		<property name="serviceDefinition">
        <bean class="org.kuali.rice.ksb.messaging.JavaServiceDefinition">
          <property name="service">
            <ref bean="enWorkgroupService" />
          </property>
          <property name="serviceInterface" value="org.kuali.rice.kew.workgroup.WorkgroupService" />
          <property name="serviceNameSpaceURI" value=""/>
          <property name="localServiceName" value="enWorkgroupService" />
        </bean>
          </property>
          <property name="propertyName" value="Identity.useRemoteServices"/>
        </bean>
-->

	<bean class="org.kuali.rice.ksb.messaging.KSBExporter">
		<property name="serviceDefinition">
        <bean class="org.kuali.rice.ksb.messaging.JavaServiceDefinition">
          <property name="service">
            <bean class="org.kuali.rice.kew.workgroup.WorkgroupMembershipChangeProcessor" />
          </property>
          <property name="localServiceName" value="WorkgroupMembershipChangeService" />
          <property name="serviceNameSpaceURI" value="" />
          <property name="priority" value="10" />
          <property name="retryAttempts" value="1" />
          <property name="messageExceptionHandler" value="org.kuali.rice.ksb.messaging.exceptionhandling.DefaultMessageExceptionHandler" />
        </bean>
		</property>
	</bean>

	<bean class="org.kuali.rice.ksb.messaging.KSBExporter">
		<property name="serviceDefinition">
        <bean class="org.kuali.rice.ksb.messaging.JavaServiceDefinition">
          <property name="service">
            <ref bean="enDocumentRoutingService" />
          </property>
          <property name="localServiceName" value="DocumentRoutingService" />
          <property name="priority" value="5"/>
          <property name="messageExceptionHandler" value="org.kuali.rice.kew.messaging.exceptionhandling.DocumentMessageExceptionHandler" />
        </bean>
		</property>
	</bean>

	<bean class="org.kuali.rice.ksb.messaging.KSBExporter">
		<property name="serviceDefinition">
        <bean class="org.kuali.rice.ksb.messaging.JavaServiceDefinition">
          <property name="service">
            <ref bean="enBlanketApproveProcessor" />
          </property>
          <property name="localServiceName" value="BlanketApproveProcessorService" />
          <property name="priority" value="4"/>
          <property name="messageExceptionHandler" value="org.kuali.rice.kew.messaging.exceptionhandling.DocumentMessageExceptionHandler" />
        </bean>
		</property>
	</bean>

	<bean class="org.kuali.rice.ksb.messaging.KSBExporter">
		<property name="serviceDefinition">
        <bean class="org.kuali.rice.ksb.messaging.JavaServiceDefinition">
          <property name="service">
            <ref bean="enSearchableAttributeProcessor" />
          </property>
          <property name="localServiceName" value="SearchableAttributeProcessorService" />
          <property name="priority" value="30"/>
          <property name="retryAttempts" value="1" />
          <property name="messageExceptionHandler" value="org.kuali.rice.ksb.messaging.exceptionhandling.DefaultMessageExceptionHandler" />
        </bean>
		</property>
	</bean>

	<bean class="org.kuali.rice.ksb.messaging.KSBExporter">
		<property name="serviceDefinition">
        <bean class="org.kuali.rice.ksb.messaging.JavaServiceDefinition">
          <property name="service">
            <bean class="org.kuali.rice.kew.actionrequest.service.impl.DocumentRequeuerImpl" />
          </property>
          <property name="localServiceName" value="DocumentRequeueProcessorService" />
          <property name="priority" value="10"/>
          <property name="retryAttempts" value="1" />
          <property name="messageExceptionHandler" value="org.kuali.rice.ksb.messaging.exceptionhandling.DefaultMessageExceptionHandler" />
        </bean>
          </property>
        </bean>


	<bean class="org.kuali.rice.ksb.messaging.KSBExporter">
		<property name="serviceDefinition">
        <bean class="org.kuali.rice.ksb.messaging.JavaServiceDefinition">
          <property name="service">
            <bean class="org.kuali.rice.kew.rule.service.impl.RuleCacheProcessorImpl" />
          </property>
          <property name="serviceNameSpaceURI" value=""/>
          <property name="localServiceName" value="RuleCacheProcessorService" />
          <property name="priority" value="3"/>
          <property name="queue" value="false"/>
          <property name="retryAttempts" value="1" />
          <property name="messageExceptionHandler" value="org.kuali.rice.ksb.messaging.exceptionhandling.DefaultMessageExceptionHandler" />
        </bean>
		</property>
	</bean>

	<bean class="org.kuali.rice.ksb.messaging.KSBExporter">
		<property name="serviceDefinition">
        <bean class="org.kuali.rice.ksb.messaging.JavaServiceDefinition">
          <property name="service">
            <bean class="org.kuali.rice.kew.rule.RolePokerProcessor" />
          </property>
          <property name="localServiceName" value="RolePokerProcessorService" />
          <property name="priority" value="10"/>
          <property name="retryAttempts" value="1" />
          <property name="messageExceptionHandler" value="org.kuali.rice.ksb.messaging.exceptionhandling.DefaultMessageExceptionHandler" />
        </bean>
		</property>
	</bean>
	
	<bean class="org.kuali.rice.ksb.messaging.PropertyConditionalKSBExporter">
		<property name="serviceDefinition">
        <bean class="org.kuali.rice.ksb.messaging.JavaServiceDefinition">
          <property name="service">
            <ref bean="enImmediateEmailReminderService" />
          </property>
          <property name="localServiceName" value="ImmediateEmailService" />
          <property name="serviceNameSpaceURI" value=""/>
          <property name="priority" value="30"/>
          <property name="retryAttempts" value="1" />
          <property name="messageExceptionHandler" value="org.kuali.rice.kew.messaging.exceptionhandling.DocumentMessageExceptionHandler" />
        </bean>
		</property>
		<property name="propertyName" value="Email.useRemoteServices"/>
	</bean>

	<bean class="org.kuali.rice.ksb.messaging.KSBExporter">
		<property name="serviceDefinition">
        <bean class="org.kuali.rice.ksb.messaging.JavaServiceDefinition">
          <property name="service">
            <ref bean="enActionInvocationService" />
          </property>
          <property name="localServiceName" value="ActionInvocationProcessor" />
          <property name="priority" value="10"/>
          <property name="retryAttempts" value="1" />
          <property name="messageExceptionHandler" value="org.kuali.rice.kew.messaging.exceptionhandling.DocumentMessageExceptionHandler" />
        </bean>
		</property>
	</bean>

	<bean class="org.kuali.rice.ksb.messaging.KSBExporter">
		<property name="serviceDefinition">
        <bean class="org.kuali.rice.ksb.messaging.JavaServiceDefinition">
          <property name="service">
            <ref bean="enMoveDocumentService" />
          </property>
          <property name="localServiceName" value="MoveDocumentProcessor" />
          <property name="priority" value="10"/>
          <property name="retryAttempts" value="1" />
          <property name="messageExceptionHandler" value="org.kuali.rice.kew.messaging.exceptionhandling.DocumentMessageExceptionHandler" />
        </bean>
    </property>
  </bean>

  <bean id="enCacheAdministrator" class="org.kuali.rice.ksb.messaging.RiceCacheExporterFactoryBean" />






  <!-- START JPA CONFIGURATION -->

  <!-- Used for @PersistenceContext auto-injection -->
  <bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor"/>  
    
  <bean id="entityManagerFactory" class="org.kuali.rice.core.jpa.spring.RiceEntityManagerProxyFactoryBean">    
    <constructor-arg value="rice.kew"/>
    <constructor-arg ref="enWorkflowDataSource"/>
  </bean>    
   
  <tx:annotation-driven transaction-manager="transactionManager"/>

  <bean id="NoResultExceptionInterceptor" class="org.kuali.rice.core.jpa.spring.NoResultExceptionInterceptor" />

  <bean class="org.springframework.aop.framework.autoproxy.BeanNameAutoProxyCreator">
    <property name="interceptorNames">
      <list>
        <idref local="NoResultExceptionInterceptor" />
      </list>
    </property>
    <property name="beanNames">
      <list>
        <idref local="enApplicationConstantsDAO"/>
        <idref local="enUserOptionsDAO"/>
        <idref local="enHelpDAO"/>
      </list>
    </property>
  </bean>
  <!-- END JPA CONFIGURATION -->

</beans>